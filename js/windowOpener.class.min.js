TGSB_WindowOpener=function(e){this._top=self;if(top!=self)try{if(top.document.location.toString())this._top=top}catch(t){}this.opts={popUnder:false,maxScreenWidth:screen.width,maxScreenHeight:screen.height,minWinWidth:0,minWinHeight:0,winWidth:parseInt(screen.width*.8),winHeight:parseInt(screen.height*.8),style:"cascade",heightRatio:null,sendPosition:false,position:{left:0,top:0,width:100,height:100},chromePPBmode:false,buildPlaceHolderUrl:function(e){},buildPlaceHolderHtml:function(e){},buildWindowName:function(e){}};this.windowCache={};this.allWindowNames={};for(var n in e)this.opts[n]=e[n];this.guid=Math.random().toString(36).substr(2,5)};TGSB_WindowOpener.prototype={open:function(e,t,n,r){if(!e)return true;var i=typeof this.opts.buildWindowName=="function"?this.opts.buildWindowName(t):false;var s=this._isWindowOpen(i)||this._getUniqueWinName(i);var o=this._openWindow(e,s,n,r);if(!o)return false;if(i&&this.windowCache[i])delete this.windowCache[i];return o},openPlaceholder:function(e){if(!e)return false;var t=typeof this.opts.buildPlaceHolderUrl=="function"?this.opts.buildPlaceHolderUrl(e):false;var n=typeof this.opts.buildPlaceHolderHtml=="function"?this.opts.buildPlaceHolderHtml(e):false;var r=typeof this.opts.buildWindowName=="function"?this.opts.buildWindowName(e):false;if(!t)t="about:blank";var i=this._getUniqueWinName(r);var s=this.opts.chromePPBmode?this._openChromePlaceholder(i,t,n):this._openDefaultPlaceholder(i,t,n);if(!s)return false;if(t=="about:blank"){this._populateBlankPage(s,n)}this.windowCache[r]=s;return s},closePlaceholder:function(e){if(!e)return false;var t=typeof this.opts.buildWindowName=="function"?this.opts.buildWindowName(e):false;if(!this.windowCache[t])return false;try{this.windowCache[t].close()}catch(n){}delete this.windowCache[t];return true},setOptions:function(e){for(var t in e)this.opts[t]=e[t]},isChromeMinVer:function(e){if(!e)return false;if(typeof window["chrome"]=="undefined")return false;if(parseInt(window.navigator.appVersion.match(/Chrome\/(\d+)\./)[1],10)>=parseInt(e))return true;else return false},_openWindow:function(e,t,n,r){var i=this._newWinTop(n,r);var s=this._newWinLeft(n,r);var o=this._newWinWidth(n,r);var u=this._newWinHeight(n,r);if(t&&typeof t=="object")return this._changeWindowLocation(t,e,i,s,o,u);if(this.opts.chromePPBmode)return this._openChromePopup(e,t);wnd=this._openDefaultPopup(e,t,i,s,o,u);if(!this.opts.popUnder)this._focusWindow(wnd);else this._blurWindow(wnd);return wnd},_openChromePopup:function(e,t){if(!e)return false;if(!t)t=this._generateWindowName();if(this.isChromeMinVer(30)){var n=this.opts.popUnder?"tab":"focusedtab";this._openWithClickTrigger("about:blank",n,t);var r=window.open(e,t);return r}var n="window";if(this.opts.style=="tab"||this.opts.popUnder)n=this.opts.popUnder?"tab":"focusedtab";this._openWithClickTrigger(e,n);return true},_openDefaultPopup:function(e,t,n,r,i,s){if(!e)return false;var o=this.opts.style=="tab"?"":"toolbar=0,scrollbars=1,location=1,statusbar=1,menubar=0,resizable=1,"+"top="+n+",left="+r+",width="+i+",height="+s;try{var u=this._top.window.open(e,t,o);return u}catch(a){return false}},_normalizeWindowName:function(e){return e&&e.replace(/[^a-zA-Z0-9_]+/,"")},_changeWindowLocation:function(e,t,n,r,i,s){if(!e||typeof e!="object")return false;try{e.resizeTo(i,s)}catch(o){}try{e.moveTo(r,n)}catch(o){}if(this.opts.sendPosition)t=this._addPos2Url(t,n,r,i,s);if(this.opts.popUnder)e.location=t;else{e=this._top.open(t,e.name);this._focusWindow(e)}return e},_populateBlankPage:function(e,t){if(!e||typeof e!="object"||!t)return false;e.document.open();e.document.write(t);e.document.close()},_newWinTop:function(e,t){if(this.opts.style=="fix")return this.opts.position.top;if(this.opts.heightRatio!==null){return Math.round(this._maxScreenHeight()*(1-this.opts.heightRatio))}if(this.opts.style=="side"){return 0}if(this.opts.style=="cascade"){return e*Math.floor((this._maxScreenHeight()-this.opts.winHeight)/t)}if(typeof this._top.window.screenTop!="undefined"){return this._top.window.screenTop}return this._top.window.screenY},_newWinLeft:function(e,t){if(this.opts.style=="fix")return this.opts.position.left;if(this.opts.style=="side"){return Math.floor(this._newWinWidth(e,t)*e)}if(this.opts.style=="cascade"){return e*Math.floor((this._maxScreenWidth()-this.opts.winWidth)/t)}if(typeof this._top.window.screenLeft!="undefined"){return this._top.window.screenLeft}return this._top.window.screenX},_newWinWidth:function(e,t){if(this.opts.style=="fix")return this.opts.position.width;if(this.opts.style=="side"){return Math.min(this.opts.maxScreenWidth,Math.floor(this._maxScreenWidth()/t-10))}if(this.opts.style=="cascade"){return this.opts.winWidth}var n=this._topWinWidth();if(this.opts.minWinWidth){return Math.max(this.opts.minWinWidth,n)}return n},_newWinHeight:function(){if(this.opts.style=="fix")return this.opts.position.height;if(this.opts.heightRatio!==null){return Math.round(this._maxScreenHeight()*this.opts.heightRatio)}if(this.opts.style=="side"){return this._maxScreenHeight()}if(this.opts.style=="cascade"){return this.opts.winHeight}var e=this._topWinHeight();if(this.opts.minWinHeight){return Math.max(this.opts.minWinHeight,e)}return e},_topWinHeight:function(){if(typeof this._top.window.innerHeight=="number"){return this._top.window.innerHeight}if(this._top.document.documentElement&&this._top.document.documentElement.clientHeight){return this._top.document.documentElement.clientHeight}if(this._top.document.body&&this._top.document.body.clientHeight){return this._top.document.body.clientHeight}return 0},_topWinWidth:function(){if(typeof this._top.window.innerWidth=="number"){return this._top.window.innerWidth}if(this._top.document.documentElement&&this._top.document.documentElement.clientWidth){return this._top.document.documentElement.clientWidth}if(this._top.document.body&&this._top.document.body.clientWidth){return this._top.document.body.clientWidth}return 0},_maxScreenWidth:function(){if(window.screen.availWidth){return window.screen.availWidth<this.opts.maxScreenWidth?window.screen.availWidth:this.opts.maxScreenWidth}return this.opts.maxScreenWidth},_maxScreenHeight:function(){if(window.screen.availHeight){return window.screen.availHeight<this.opts.maxScreenHeight?window.screen.availHeight:this.opts.maxScreenHeight}return this.opts.maxScreenHeight},_addPos2Url:function(e,t,n,r,i){if(!e)return false;var s=e.indexOf("?")=="-1"?"?":"&";return e+=s+"resizeTo[t]="+t+"&resizeTo[l]="+n+"&resizeTo[w]="+r+"&resizeTo[h]="+i},_blurWindow:function(e){if(typeof e!="object")return false;e.blur();if(navigator.userAgent.toLowerCase().indexOf("applewebkit")>-1)this._top.window.blur();this._top.window.focus();this._extendPopUpWindow(e);try{e.sendFocus2Parent(e)}catch(t){}try{this._top.window.open("javascript:window.focus();","_self")}catch(n){}return true},_focusWindow:function(e){if(e&&e.focus)e.focus()},_extendPopUpWindow:function(e){var t={sendFocus2Parent:function(e){this._handleMozzEngine();try{e.opener.window.focus()}catch(t){}},_handleMozzEngine:function(){if(typeof window.mozPaintCount!=="undefined"||typeof navigator.webkitGetUserMedia==="function"){var e=this.window.open("about:blank");e.close()}}};try{for(var n in t)e[n]=t[n]}catch(r){}},_generateWindowName:function(){var e="rnd_"+Math.random().toString(36).substr(2,8);return this._getUniqueWinName(e)},_getUniqueWinName:function(e){if(!e)return false;e=this._normalizeWindowName(e);e+="_"+this.guid+"_";for(var t=0;this.allWindowNames[e+t];t++);this.allWindowNames[e+t]=1;return e+t},_isWindowOpen:function(e){return e&&this.windowCache[e]&&!this.windowCache[e].closed&&this.windowCache[e]},_openChromePlaceholder:function(e,t,n){if(!e||!t)return false;this._openWithClickTrigger("about:blank","tab",e);return window.open(t,e)},_openDefaultPlaceholder:function(e,t,n){if(!e||!t)return false;var r=this.opts.position;var i=this._openDefaultPopup(t,e,r.top,r.left,r.width,r.height);if(!i)return false;this._blurWindow(i);return i},_openWithClickTrigger:function(e,t,n){if(!e||!t)return false;var r=document.createElement("a");r.href=e;if(n)r.target=n;document.body.appendChild(r);var i=t=="tab"||t=="focusedtab"?true:false;var s=t=="window"||t=="focusedtab"?true:false;var o=this._getClickEvent(i,s,false);r.dispatchEvent(o);r.parentNode.removeChild(r);return true},_getClickEvent:function(e,t,n){var r=document.createEvent("MouseEvents");var i={type:"click",canBubble:false,cancelable:true,view:window,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:e?true:false,altKey:n?true:false,shiftKey:t?true:false,metaKey:true,button:0,relatedTarget:null};r.initMouseEvent(i.type,i.canBubble,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget);return r}}
/*compressed with: jscompress.com*/